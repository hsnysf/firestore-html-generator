<!DOCTYPE html>
<html>
	<head>
	
		<title>Manager Management</title>
		
		<meta http-equiv="Expires" content="-1">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Cache-Control" content="no-cache">

		<meta charset="UTF-8">
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="viewport" content="width = device-width, initial-scale = 1, user-scalable = no">

		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
		<script src="https://www.malot.fr/bootstrap-datetimepicker/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.7.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.7.0/firebase-firestore.js"></script>
		
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<link href="https://www.malot.fr/bootstrap-datetimepicker/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css" rel="stylesheet">
		<link href="https://icons.getbootstrap.com/assets/font/bootstrap-icons.css" rel="stylesheet">
		
	    <link rel="shortcut icon" href="https://upload.wikimedia.org/wikipedia/en/thumb/3/30/Java_programming_language_logo.svg/800px-Java_programming_language_logo.svg.png">
		<link rel="apple-touch-icon" href="https://upload.wikimedia.org/wikipedia/en/thumb/3/30/Java_programming_language_logo.svg/800px-Java_programming_language_logo.svg.png">
		<link rel="apple-touch-startup-image" href="https://upload.wikimedia.org/wikipedia/en/thumb/3/30/Java_programming_language_logo.svg/800px-Java_programming_language_logo.svg.png">
		<link rel="apple-touch-icon-precomposed" href="https://upload.wikimedia.org/wikipedia/en/thumb/3/30/Java_programming_language_logo.svg/800px-Java_programming_language_logo.svg.png">
	
	</head>
	<body>
	
		<div class="container-fluid" ng-app="application" ng-controller="controller">
		
			<h4 class="pb-2 mt-4 mb-3 border-bottom">
				Manager Management
			</h4>
			
			<div id="alert" ng-class="alert.class" ng-bind="alert.message" class="alert fw-bold text-center" role="alert">
			</div>
			
			<div class="card">
				<div class="card-header fw-bold">
					Manager Search
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="id" class="form-label">Id</label>
								<input id="id" ng-model="managerSearch.id" type="tel" class="form-control is-valid" placeholder="Id" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="name" class="form-label">Name</label>
								<input id="name" ng-model="managerSearch.name" type="text" class="form-control is-valid name" placeholder="Name" maxlength="100" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="gender" class="form-label">Gender</label>
								<input id="gender" ng-model="managerSearch.gender" type="text" class="form-control is-valid" placeholder="Gender" maxlength="1" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="age" class="form-label">Age</label>
								<input id="age" ng-model="managerSearch.age" type="tel" class="form-control is-valid age" placeholder="Age" maxlength="2" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="cpr" class="form-label">Cpr</label>
								<input id="cpr" ng-model="managerSearch.cpr" type="tel" class="form-control is-valid cpr" placeholder="Cpr" maxlength="9" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="mobile" class="form-label">Mobile</label>
								<input id="mobile" ng-model="managerSearch.mobile" type="tel" class="form-control is-valid mobile" placeholder="Mobile" maxlength="8" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="id" class="form-label">Address Id</label>
								<input id="id" ng-model="managerSearch.address.id" type="tel" class="form-control is-valid" placeholder="Address Id" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="building" class="form-label">Address Building</label>
								<input id="building" ng-model="managerSearch.address.building" type="tel" class="form-control is-valid" placeholder="Address Building" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="road" class="form-label">Address Road</label>
								<input id="road" ng-model="managerSearch.address.road" type="tel" class="form-control is-valid" placeholder="Address Road" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="block" class="form-label">Address Block</label>
								<input id="block" ng-model="managerSearch.address.block" type="tel" class="form-control is-valid" placeholder="Address Block" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="id" class="form-label">City Id</label>
								<input id="id" ng-model="managerSearch.address.city.id" type="tel" class="form-control is-valid" placeholder="City Id" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="name" class="form-label">City Name</label>
								<input id="name" ng-model="managerSearch.address.city.name" type="text" class="form-control is-valid name" placeholder="City Name" maxlength="100" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="active" class="form-label">City Active</label>
								<select id="active" ng-model="managerSearch.address.city.active" class="form-control is-valid" placeholder="City Active" autocomplete="off">
									<option ng-value="">City Active</option>
									<option ng-value="true">Yes</option>
									<option ng-value="false">No</option>
								</select>
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="active" class="form-label">Address Active</label>
								<select id="active" ng-model="managerSearch.address.city.active" class="form-control is-valid" placeholder="Address Active" autocomplete="off">
									<option ng-value="">Address Active</option>
									<option ng-value="true">Yes</option>
									<option ng-value="false">No</option>
								</select>
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="active" class="form-label">Active</label>
								<select id="active" ng-model="managerSearch.active" class="form-control is-valid" placeholder="Active" autocomplete="off">
									<option ng-value="">Active</option>
									<option ng-value="true">Yes</option>
									<option ng-value="false">No</option>
								</select>
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="degree" class="form-label">Degree</label>
								<input id="degree" ng-model="managerSearch.degree" type="tel" class="form-control is-valid" placeholder="Degree" maxlength="10" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="allowance" class="form-label">Allowance</label>
								<input id="allowance" ng-model="managerSearch.allowance" type="number" class="form-control is-valid" placeholder="Allowance" maxlength="17" autocomplete="off">
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="time" class="form-label">Last Update</label>
								<div class="input-append date input-group">
									<input id="time" type="text" ng-model="time" maxlength="10" class="form-control is-valid date-picker" placeholder="Last Update" autocomplete="off">
									<i class="input-group-text bi bi-calendar3"></i>
								</div>
							</div>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-4">
							<div class="mb-3">
								<label for="limit" class="form-label">Manager Count</label>
								<select id="limit" ng-model="limit" class="form-control is-valid" placeholder="Manager Count" autocomplete="off">
									<option ng-value="">Manager Count</option>
									<option ng-value="50">50</option>
									<option ng-value="100">100</option>
									<option ng-value="150">150</option>
									<option ng-value="200">200</option>
								</select>
							</div>
						</div>
					</div>
				</div>
				<div class="card-footer text-center">
					<button type="button" class="btn btn-dark" ng-click="searchManagers(true)">Search</button>
				</div>
			</div>
			
			<div class="card mt-4">
				<div class="card-header fw-bold">
					Manager List
				</div>
				<div class="table-responsive">
					<table class="table table-striped">
						<thead>
							<tr>
								<th>
									#
								</th>
								<th>
									Id
								</th>
								<th>
									Name
								</th>
								<th>
									Gender
								</th>
								<th>
									Age
								</th>
								<th>
									Cpr
								</th>
								<th>
									Mobile
								</th>
								<th>
									Address Id
								</th>
								<th>
									Address Building
								</th>
								<th>
									Address Road
								</th>
								<th>
									Address Block
								</th>
								<th>
									City Id
								</th>
								<th>
									City Name
								</th>
								<th>
									City Active
								</th>
								<th>
									Address Active
								</th>
								<th>
									Active
								</th>
								<th>
									Degree
								</th>
								<th>
									Allowance
								</th>
								<th>
									<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#managerModal" ng-click="toAddManager()">Add</button>
								</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="manager in managers">
								<td>
									{{$index + 1}}
								</td>
								<td>
									{{manager.id}}
								</td>
								<td>
									{{manager.name}}
								</td>
								<td>
									{{manager.gender}}
								</td>
								<td>
									{{manager.age}}
								</td>
								<td>
									{{manager.cpr}}
								</td>
								<td>
									{{manager.mobile}}
								</td>
								<td>
									{{manager.address.id}}
								</td>
								<td>
									{{manager.address.building}}
								</td>
								<td>
									{{manager.address.road}}
								</td>
								<td>
									{{manager.address.block}}
								</td>
								<td>
									{{manager.address.city.id}}
								</td>
								<td>
									{{manager.address.city.name}}
								</td>
								<td>
									{{manager.address.city.active ? 'Yes' : 'No'}}
								</td>
								<td>
									{{manager.address.city.active ? 'Yes' : 'No'}}
								</td>
								<td>
									{{manager.active ? 'Yes' : 'No'}}
								</td>
								<td>
									{{manager.degree}}
								</td>
								<td>
									{{manager.allowance}}
								</td>
								<th>
									<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#viewModal" ng-click="selectManager(manager)">View</button>
									<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#managerModal" ng-click="toUpdateManager(manager)">Edit</button>
									<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#activateModal" ng-if="!manager.active" ng-click="selectManager(manager)">Activate</button>
									<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#activateModal" ng-if="manager.active" ng-click="selectManager(manager)">Deactivate</button>
								</th>
							</tr>
							<tr ng-show="managersLoading">
								<td align="center" colspan="20">
									<div class="spinner-border" role="status">
										<span class="sr-only"></span>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal fade" id="managerModal">
				<div class="modal-dialog modal-xl">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">{{manager.id == null ? 'Add' : 'Update'}} Manager</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div id="alert" ng-class="alert.class" ng-bind="alert.message" class="alert fw-bold text-center" role="alert">
							</div>
							<div class="card mt-4">
								<div class="card-header fw-bold">
									Manager Details
								</div>
								<div class="card-body">
									<div class="row">
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="name" class="form-label">Name</label>
												<input id="name" ng-model="manager.name" type="text" class="form-control is-valid name required" placeholder="Name" maxlength="100" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="gender" class="form-label">Gender</label>
												<input id="gender" ng-model="manager.gender" type="text" class="form-control is-valid required" placeholder="Gender" maxlength="1" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="age" class="form-label">Age</label>
												<input id="age" ng-model="manager.age" type="tel" class="form-control is-valid age required" placeholder="Age" maxlength="2" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="cpr" class="form-label">Cpr</label>
												<input id="cpr" ng-model="manager.cpr" type="tel" class="form-control is-valid cpr required" placeholder="Cpr" maxlength="9" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="mobile" class="form-label">Mobile</label>
												<input id="mobile" ng-model="manager.mobile" type="tel" class="form-control is-valid mobile required" placeholder="Mobile" maxlength="8" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="building" class="form-label">Address Building</label>
												<input id="building" ng-model="manager.address.building" type="tel" class="form-control is-valid required" placeholder="Address Building" maxlength="10" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="road" class="form-label">Address Road</label>
												<input id="road" ng-model="manager.address.road" type="tel" class="form-control is-valid required" placeholder="Address Road" maxlength="10" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="block" class="form-label">Address Block</label>
												<input id="block" ng-model="manager.address.block" type="tel" class="form-control is-valid required" placeholder="Address Block" maxlength="10" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="name" class="form-label">City Name</label>
												<input id="name" ng-model="manager.address.city.name" type="text" class="form-control is-valid name" placeholder="City Name" maxlength="100" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="degree" class="form-label">Degree</label>
												<input id="degree" ng-model="manager.degree" type="tel" class="form-control is-valid" placeholder="Degree" maxlength="10" autocomplete="off">
											</div>
										</div>
										<div class="col-sm-12 col-md-6 col-lg-4">
											<div class="mb-3">
												<label for="allowance" class="form-label">Allowance</label>
												<input id="allowance" ng-model="manager.allowance" type="number" class="form-control is-valid" placeholder="Allowance" maxlength="17" autocomplete="off">
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="card mt-4">
								<div class="card-header fw-bold">
									Certificate List
								</div>
								<div class="table-responsive">
									<table class="table table-striped">
										<thead>
											<tr>
												<th>
													#
												</th>
												<th>
													Employee Id
												</th>
												<th>
													Title
												</th>
												<th>
													Year
												</th>
												<th>
													<button type="button" class="btn btn-dark" ng-click="addCertificate($index)">Add</button>
												</th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="certificate in manager.certificates">
												<td>
													{{$index + 1}}
												</td>
												<td>
													<div class="mb-3">
														<input id="employeeId" ng-model="certificate.employeeId" type="tel" class="form-control is-valid" placeholder="Employee Id" maxlength="10" autocomplete="off">
													</div>
												</td>
												<td>
													<div class="mb-3">
														<input id="title" ng-model="certificate.title" type="text" class="form-control is-valid" placeholder="Title" maxlength="200" autocomplete="off">
													</div>
												</td>
												<td>
													<div class="mb-3">
														<input id="year" ng-model="certificate.year" type="tel" class="form-control is-valid" placeholder="Year" maxlength="10" autocomplete="off">
													</div>
												</td>
												<th>
													<button type="button" class="btn btn-dark" ng-click="addCertificate($index)">+</button>
													<button type="button" class="btn btn-dark" ng-click="deleteCertificate($index)">-</button>
												</th>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-dark" ng-if="manager.id == null" ng-click="addManager()">Add</button>
							<button type="button" class="btn btn-dark" ng-if="manager.id != null" ng-click="updateManager()">Update</button>
							<button type="button" class="btn btn-dark" data-bs-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
			<div class="modal fade" id="viewModal">
				<div class="modal-dialog modal-xl">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">View Manager</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div class="card mt-4">
								<div class="card-header fw-bold">
									Manager Details
								</div>
								<div class="table-responsive">
									<table class="table table-striped">
										<tbody>
											<tr>
												<th>
													Id
												</th>
												<td>
													{{manager.id}}
												</td>
											</tr>
											<tr>
												<th>
													Name
												</th>
												<td>
													{{manager.name}}
												</td>
											</tr>
											<tr>
												<th>
													Gender
												</th>
												<td>
													{{manager.gender}}
												</td>
											</tr>
											<tr>
												<th>
													Age
												</th>
												<td>
													{{manager.age}}
												</td>
											</tr>
											<tr>
												<th>
													Cpr
												</th>
												<td>
													{{manager.cpr}}
												</td>
											</tr>
											<tr>
												<th>
													Mobile
												</th>
												<td>
													{{manager.mobile}}
												</td>
											</tr>
											<tr>
												<th>
													Address Id
												</th>
												<td>
													{{manager.address.id}}
												</td>
											</tr>
											<tr>
												<th>
													Address Building
												</th>
												<td>
													{{manager.address.building}}
												</td>
											</tr>
											<tr>
												<th>
													Address Road
												</th>
												<td>
													{{manager.address.road}}
												</td>
											</tr>
											<tr>
												<th>
													Address Block
												</th>
												<td>
													{{manager.address.block}}
												</td>
											</tr>
											<tr>
												<th>
													City Id
												</th>
												<td>
													{{manager.address.city.id}}
												</td>
											</tr>
											<tr>
												<th>
													City Name
												</th>
												<td>
													{{manager.address.city.name}}
												</td>
											</tr>
											<tr>
												<th>
													City Active
												</th>
												<td>
													{{manager.address.city.active ? 'Yes' : 'No'}}
												</td>
											</tr>
											<tr>
												<th>
													Address Active
												</th>
												<td>
													{{manager.address.city.active ? 'Yes' : 'No'}}
												</td>
											</tr>
											<tr>
												<th>
													Active
												</th>
												<td>
													{{manager.active ? 'Yes' : 'No'}}
												</td>
											</tr>
											<tr>
												<th>
													Degree
												</th>
												<td>
													{{manager.degree}}
												</td>
											</tr>
											<tr>
												<th>
													Allowance
												</th>
												<td>
													{{manager.allowance}}
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<div class="card mt-4">
								<div class="card-header fw-bold">
									Certificate List
								</div>
								<div class="table-responsive">
									<table class="table table-striped">
										<thead>
											<tr>
												<th>
													#
												</th>
												<th>
													Employee Id
												</th>
												<th>
													Title
												</th>
												<th>
													Year
												</th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="certificate in manager.certificates">
												<td>
													{{$index + 1}}
												</td>
												<td>
													{{certificate.employeeId}}
												</td>
												<td>
													{{certificate.title}}
												</td>
												<td>
													{{certificate.year}}
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-dark" data-bs-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
			<div class="modal fade" id="activateModal">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">{{manager.active ? 'Deactivate' : 'Activate'}} Manager</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<h4>Are you sure to {{manager.active ? 'deactivate' : 'activate'}} Manager</h4>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-dark" data-bs-dismiss="modal" ng-if="!manager.active" ng-click="updateManagerActive()">Activate</button>
							<button type="button" class="btn btn-dark" data-bs-dismiss="modal" ng-if="manager.active" ng-click="updateManagerActive()">Deactivate</button>
							<button type="button" class="btn btn-dark" data-bs-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			
			var application = angular.module("application", []);
		
			application.controller("controller", 

				function($scope, $timeout){
					
					$scope.managersLoading = true;
					$scope.maxManagerId = 0;
					$scope.limit = 50;
					$scope.time = getLastMonthDate();
					
					$scope.alert = {class:"d-none", message:null};
					$scope.managers = new Array();
					$scope.managerSearch = new Object();
					$scope.managerSearch.active = true;
					$scope.manager = new Object();
					
					$scope.manager.certificates = new Array();
					
					$(".date-picker").datetimepicker({
						minView: 2,
						maxView: 2,
						format: "dd-mm-yyyy",
						autoclose: true,
						todayBtn: true,
					});
					
					firebase.firestore().collection("managers").orderBy("id", "desc").limit(1).onSnapshot(function(snapshot) {
						
						snapshot.docChanges().forEach(function(change) {
							
							if (change.type === "added") {
								
								$scope.maxManagerId = Number(change.doc.id);
							}
						});
					});
					
					$scope.searchManagers = function(alert){
						
						$scope.managers = new Array();
						
						$scope.managersLoading = true;
						
						var managersRef = firebase.firestore().collection("managers");
						
						var properties = getProperties($scope.managerSearch, "");
						
						for(let property in properties){
							
							if(properties[property] != null
								&& properties[property] != ""){
								
								managersRef = managersRef.where(property, "==", properties[property]);
							}
						}
						
						if($scope.time != null 
							&& $scope.time != ""){
							
							managersRef = managersRef.where("time", ">=", $scope.time);
						}
						
						if($scope.limit != null 
							&& $scope.limit != ""){
							
							managersRef = managersRef.limit($scope.limit);
						}
						
						if(alert){
							$scope.alert = {class:"alert-warning", message:"Please wait"};
						}
						
						managersRef.get().then(function(snapshot){
							
							if(alert){
								$scope.alert = {class:"d-none", message:null};
							}
							
							snapshot.forEach(function(document) {
								
								$scope.managers.push(document.data());
							});
							
							$scope.managersLoading = false;
							
							$scope.$digest();
						});
					}
					
					$scope.searchManagers(true);
					
					$scope.selectManager = function(manager){
						
						$scope.manager = Object.assign(new Object, manager);
					}
					
					$scope.toAddManager = function(){
						
						$scope.alert = {class:"alert-info", message:"Please enter Manager Details"};
						
						$scope.manager = new Object();
						
						$scope.manager.certificates = new Array();
					}
					
					$scope.addManager = function(){
						
						window.scrollTo(0, 0);
						
						var result = isValidForm();
						
						if(result == null){
							
							$("#managerModal").modal("hide");
							
							$scope.alert = {class:"alert-warning", message:"Please wait"};
							
							$scope.manager.id = $scope.maxManagerId + 1;
							$scope.manager.active = true;
							$scope.manager.time = getTime();
							
							firebase.firestore().collection("managers").doc(String($scope.manager.id)).set($scope.manager).then(function(reference){
								
								$scope.alert = {class:"alert-success", message:"Manager with ID#" + $scope.manager.id + " has been added successfully"};
								
								$scope.searchManagers(false);
								
								$scope.$digest();
							
							}).catch(function(error){
								
								$scope.alert = {class:"alert-danger", message:result};
							});
							
						}else{
							
							$scope.alert = {class:"alert-danger", message:result};
						}
					}
					
					$scope.toUpdateManager = function(manager){
						
						$scope.alert = {class:"alert-info", message:"Please update Manager Details"};
						
						$scope.manager = Object.assign(new Object, manager);
						
						if($scope.manager.certificates == null){
							$scope.manager.certificates = new Array();
						}
						
						
						$timeout(function(){
							
							isValidForm();
						})
					}
					
					$scope.updateManager = function(){
						
						window.scrollTo(0, 0);
						
						var result = isValidForm();
						
						if(result == null){
							
							$("#managerModal").modal("hide");
							
							$scope.alert = {class:"alert-warning", message:"Please wait"};
							
							$scope.manager.time = getTime();
							
							firebase.firestore().collection("managers").doc(String($scope.manager.id)).set($scope.manager).then(function(reference){
								
								$scope.alert = {class:"alert-success", message:"Manager with ID#" + $scope.manager.id + " has been updated successfully"};
								
								$scope.searchManagers(false);
								
								$scope.$digest();
							
							}).catch(function(error){
								
								$scope.alert = {class:"alert-danger", message:result};
							});
							
						}else{
							
							$scope.alert = {class:"alert-danger", message:result};
						}
					}
					
					$scope.updateManagerActive = function(){
						
						window.scrollTo(0, 0);
						
						$scope.alert = {class:"alert-warning", message:"Please wait"};
						
						$scope.manager.active = !$scope.manager.active;
						$scope.manager.time = getTime();
						
						firebase.firestore().collection("managers").doc(String($scope.manager.id)).set($scope.manager).then(function(reference){
							
							if($scope.manager.active){
								
								$scope.alert = {class:"alert-success", message:"Manager with ID#" + $scope.manager.id + " has been activated successfully"};
								
							}else{
								
								$scope.alert = {class:"alert-success", message:"Manager with ID#" + $scope.manager.id + " has been deactivated successfully"};
							}
							
							$scope.searchManagers(false);
							
							$scope.$digest();
							
						}).catch(function(error){
							
							$scope.alert = {class:"alert-danger", message:result};
						});
					}
					
					$scope.addCertificate = function(index){
						$scope.manager.certificates.splice(index, 0, new Object());
					}
					
					$scope.deleteCertificate = function(index){
						$scope.manager.certificates.splice(index, 1);
					}
				}
			);
			
		</script>
		<script src="common.js"></script>
	</body>
</html>